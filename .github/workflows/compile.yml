name: Compiler LaTeX

on:
  workflow_dispatch:  # Permet de lancer manuellement

jobs:
  compile:
    runs-on: ubuntu-latest
    timeout-minutes: 5
    
    steps:
    - name: Checkout
      uses: actions/checkout@v4

    - name: Setup LuaLaTeX
      run: |
        sudo apt-get update
        sudo apt-get install -y texlive-luatex

    - name: Créer le fichier LaTeX
      run: |
        cat > document.tex << 'EOF'
        \documentclass{article}
        \usepackage[utf8]{inputenc}
        \usepackage[french]{babel}
        
        \title{Mon Document}
        \author{Moi}
        \date{\today}
        
        \begin{document}
        
        \maketitle
        
        \section{Introduction}
        Bonjour ! Ce document a été compilé par GitHub Actions !
        
        \section{Test}
        Voici une formule : $E = mc^2$
        
        \end{document}
        EOF

    - name: Compiler
      run: |
        lualatex --interaction=nonstopmode document.tex

    - name: Vérifier le PDF
      run: |
        if [ -f "document.pdf" ]; then
            echo "✅ SUCCÈS ! PDF créé."
            ls -la document.pdf
        else
            echo "❌ ÉCHEC : Pas de PDF"
            exit 1
        fi

    - name: Sauvegarder le PDF
      uses: actions/upload-artifact@v4
      with:
        name: mon-document
        path: document.pdf