name: ğŸš€ Compiler LaTeX Rapide

on:
  workflow_dispatch:

jobs:
  compile:
    runs-on: ubuntu-latest
    timeout-minutes: 6
    
    steps:
    - name: ğŸš€ Checkout
      uses: actions/checkout@v4

    - name: ğŸ“¦ Installer LuaLaTeX (minimal)
      run: |
        echo "Installation de LaTeX minimal..."
        sudo apt-get update
        # Installation MINIMALE et RAPIDE
        sudo apt-get install -y --no-install-recommends \
            texlive-luatex \
            texlive-base \
            texlive-fonts-recommended \
            texlive-latex-base
        
        echo "VÃ©rification..."
        lualatex --version

    - name: CrÃ©er le fichier de test
      run: |
        echo '\documentclass{article}' > test.tex
        echo '\begin{document}' >> test.tex
        echo 'Hello World! Compilation rÃ©ussie!' >> test.tex
        echo '\end{document}' >> test.tex
        
        echo "ğŸ“‹ Contenu du fichier :"
        cat test.tex

    - name: Compiler avec LuaLaTeX
      run: |
        echo "ğŸš€ Compilation en cours..."
        lualatex --interaction=nonstopmode test.tex
        
        echo "ğŸ“Š RÃ©sultat :"
        ls -la

    - name: VÃ©rifier le PDF
      run: |
        if [ -f "test.pdf" ]; then
            echo "âœ… SUCCÃˆS ! PDF crÃ©Ã© avec succÃ¨s!"
            echo "ğŸ“ Taille : $(du -h test.pdf | cut -f1)"
        else
            echo "âŒ Ã‰CHEC : Aucun PDF gÃ©nÃ©rÃ©"
            echo "ğŸ” Listing des fichiers :"
            ls -la
            exit 1
        fi

    - name: TÃ©lÃ©charger le PDF
      uses: actions/upload-artifact@v4
      with:
        name: document-pdf
        path: test.pdf