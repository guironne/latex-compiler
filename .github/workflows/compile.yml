name: Compiler LaTeX

on:
  workflow_dispatch:

jobs:
  compile:
    runs-on: ubuntu-latest
    timeout-minutes: 5
    
    steps:
    - name: Checkout
      uses: actions/checkout@v4

    - name: Installer LaTeX complet
      run: |
        echo "ðŸ“¦ Installation de LaTeX..."
        sudo apt-get update
        sudo apt-get install -y texlive-latex-base texlive-luatex texlive-fonts-recommended

    - name: VÃ©rifier l'installation
      run: |
        echo "ðŸ” VÃ©rification des compilateurs..."
        which lualatex
        lualatex --version

    - name: CrÃ©er le fichier LaTeX
      run: |
        cat > document.tex << 'EOF'
\documentclass{article}
\usepackage[utf8]{inputenc}
\usepackage[french]{babel}

\title{Mon Document}
\author{GitHub Actions}
\date{\today}

\begin{document}

\maketitle

\section{Introduction}
Bonjour ! Ce document a Ã©tÃ© compilÃ© par GitHub Actions !

\section{Test}
Voici une formule mathÃ©matique : $E = mc^2$

\begin{itemize}
    \item Item 1
    \item Item 2
    \item Item 3
\end{itemize}

\end{document}
EOF

        echo "ðŸ“‹ Fichier crÃ©Ã© :"
        cat document.tex

    - name: Compiler avec LuaLaTeX
      run: |
        echo "ðŸš€ Compilation en cours..."
        lualatex --interaction=nonstopmode document.tex
        
        # DeuxiÃ¨me passage pour les rÃ©fÃ©rences
        lualatex --interaction=nonstopmode document.tex

    - name: VÃ©rifier le PDF
      run: |
        if [ -f "document.pdf" ]; then
            echo "âœ… SUCCÃˆS ! PDF crÃ©Ã©."
            echo "ðŸ“Š Taille : $(du -h document.pdf | cut -f1)"
        else
            echo "âŒ Ã‰CHEC : Pas de PDF"
            echo "ðŸ“œ Contenu du dossier :"
            ls -la
            exit 1
        fi

    - name: Sauvegarder le PDF
      uses: actions/upload-artifact@v4
      with:
        name: document-pdf
        path: document.pdf